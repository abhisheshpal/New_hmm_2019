<?xml version="1.0" ?>
<launch>
  <arg name="simple_sim" default="true"/>
  <arg name="with_teleoperation" default="false" />

  <!-- Robot model arguments.  -->
  <arg name="robot_name" default="thorvald_001" />
  <arg name="robot_model" default="$(find rasberry_bringup)/config/robot_007.yaml"/>
  <arg name="model_extras" default="$(find rasberry_bringup)/urdf/robot_007_sensors.xacro"/>
  <arg name="tf_prefix" default="$(arg robot_name)" />
  <arg name="joy_dev" default="/dev/input/js0" />
  <!-- Robot starting pose arguments for simulation  -->
  <arg name="start_pose_x" default="0" if="$(arg simple_sim)"/>
  <arg name="start_pose_y" default="0" if="$(arg simple_sim)"/>
  <arg name="start_pose_z" default="0" if="$(arg simple_sim)"/>
  <arg name="start_pose_R" default="0" if="$(arg simple_sim)"/>
  <arg name="start_pose_P" default="0" if="$(arg simple_sim)"/>
  <arg name="start_pose_Y" default="-1.7" if="$(arg simple_sim)"/>

  <group ns="$(arg robot_name)">
    <!-- model bringup -->
    <include file="$(find thorvald_description)/launch/model.launch">
      <arg name="robot_name" value="$(arg robot_name)" />
      <arg name="tf_prefix" value="$(arg tf_prefix)" />
      <arg name="robot_model" value="$(arg robot_model)" />
      <arg name="model_extras" value="$(arg model_extras)" />
    </include>
    <!-- base bringup-->
    <include file="$(find thorvald_base)/launch/base_bringup.launch">
      <arg name="tf_prefix" value="$(arg tf_prefix)" />
      <arg name="robot_model" value="$(arg robot_model)" />
      <arg name="simple_sim" value="$(arg simple_sim)" />
      <arg name="enable_odom_tf" value="false" if="$(arg simple_sim)"/>
      <arg name="odom_frame_id" value="odom" />
    </include>
    <!-- teleop bringup -->
    <include file="$(find thorvald_teleop)/launch/teleop_xbox.launch" if="$(arg with_teleoperation)">
      <arg name="joy_dev" value="$(arg joy_dev)" />
    </include>
    <!-- twist mux bringup -->
    <include file="$(find thorvald_twist_mux)/launch/twist_mux.launch" />
    <!-- spawn robot in gazebo -->
    <node pkg="gazebo_ros" type="spawn_model" name="spawner" args="-urdf -param robot_description -model $(arg robot_name) -x $(arg start_pose_x) -y $(arg start_pose_y) -z $(arg start_pose_z) -R $(arg  start_pose_R)  -P $(arg start_pose_P)  -Y $(arg start_pose_Y)" if="$(arg simple_sim)"/>
  </group>

</launch>
